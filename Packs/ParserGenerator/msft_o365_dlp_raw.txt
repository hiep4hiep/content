
[INGEST: vendor=msft, product=o365_dlp, target_dataset=msft_o365_dlp_raw, no_hit=keep]
| alter PolicyDetails = arrayindex(json_extract_array(to_json_string(PolicyDetails),"$."),0)
| alter PolicyDetails_PolicyId = PolicyDetails -> ["PolicyId"]
| alter PolicyDetails_Rules = PolicyDetails -> Rules[]
| alter PolicyDetails_Rules = arrayindex(json_extract_array(to_json_string(PolicyDetails_Rules),"$."),0)
| alter PolicyDetails_Rules_Actions = PolicyDetails_Rules -> Actions[]
| alter PolicyDetails_Rules_ConditionsMatched = PolicyDetails_Rules -> ConditionsMatched{}
| alter PolicyDetails_Rules_ConditionsMatched_ConditionMatchedInNewScheme = PolicyDetails_Rules_ConditionsMatched -> ConditionMatchedInNewScheme
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions = PolicyDetails_Rules_ConditionsMatched -> OtherConditions[]
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions = arrayindex(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_OtherConditions),"$."),0)
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions_SensitivityLabels = arrayindex(arrayfilter(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_OtherConditions),"$"),"@element" contains "SensitivityLabels"),0) -> Value
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions_Name = PolicyDetails_Rules_ConditionsMatched_OtherConditions -> ["Name"]
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions_Value = PolicyDetails_Rules_ConditionsMatched_OtherConditions -> ["Value"]
| alter PolicyDetails_Rules_RuleId = PolicyDetails_Rules -> ["RuleId"]
| alter PolicyDetails_Rules_RuleMode = PolicyDetails_Rules -> ["RuleMode"]
| alter PolicyDetails_Rules_RuleName = PolicyDetails_Rules -> ["RuleName"]
| alter PolicyDetails_Rules_Severity = PolicyDetails_Rules -> ["Severity"]
| alter ExchangeMetaData_BCC = ExchangeMetaData -> BCC[]
| alter ExchangeMetaData_CC = ExchangeMetaData -> CC[]
| alter ExchangeMetaData_FileSize = ExchangeMetaData -> FileSize
| alter ExchangeMetaData_From = ExchangeMetaData -> From
| alter ExchangeMetaData_IsViewableByExternalUsers = ExchangeMetaData -> IsViewableByExternalUsers
| alter ExchangeMetaData_MessageID = ExchangeMetaData -> MessageID
| alter ExchangeMetaData_RecipientCount = ExchangeMetaData -> RecipientCount
| alter ExchangeMetaData_Sent = ExchangeMetaData -> Sent
| alter ExchangeMetaData_Subject = ExchangeMetaData -> Subject
| alter ExchangeMetaData_To = ExchangeMetaData -> To[]
| alter ExchangeMetaData_To = arrayindex(json_extract_array(to_json_string(ExchangeMetaData_To),"$."),0)
| alter ExchangeMetaData_UniqueID = ExchangeMetaData -> UniqueID
| alter ExchangeMetaData_CC = arrayindex(json_extract_array(to_json_string(ExchangeMetaData_CC),"$."),0)
| alter PolicyDetails_Rules_Actions = arrayindex(json_extract_array(to_json_string(PolicyDetails_Rules_Actions),"$."),0)
| alter ExchangeMetaData_BCC = arrayindex(json_extract_array(to_json_string(ExchangeMetaData_BCC),"$."),0)
| alter ExchangeMetaData_AttachmentDetails = ExchangeMetaData -> AttachmentDetails[]
| alter PolicyDetails_PolicyName = PolicyDetails -> ["PolicyName"]
| alter PolicyDetails_Rules_ActionParameters = PolicyDetails_Rules -> ActionParameters[]
| alter PolicyDetails_Rules_ActionParameters = arrayindex(json_extract_array(to_json_string(PolicyDetails_Rules_ActionParameters),"$."),0)
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions_AccessScope = arrayindex(arrayfilter(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_OtherConditions),"$"),"@element" contains "AccessScope"),0) -> Value
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions_FromMemberOf = arrayindex(arrayfilter(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_OtherConditions),"$"),"@element" contains "FromMemberOf"),0) -> Value
| alter PolicyDetails_Rules_ConditionsMatched_OtherConditions_RecipientDomainIs = arrayindex(arrayfilter(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_OtherConditions),"$"),"@element" contains "RecipientDomainIs"),0) -> Value
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation = PolicyDetails_Rules_ConditionsMatched -> SensitiveInformation[]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation = arrayindex(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_SensitiveInformation),"$."),0)
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_ClassifierType = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> ["ClassifierType"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_Confidence = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> Confidence
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_Count = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> Count
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_Location = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> ["Location"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> SensitiveInformationDetailedClassificationAttributes[]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes_Confidence = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes -> Confidence
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes_Count = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes -> Count
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes_IsMatch = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetailedClassificationAttributes -> IsMatch
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> SensitiveInformationDetections{}
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections -> DetectedValues[]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues = arrayindex(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues),"$."),0)
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues_LEGO = arrayindex(arrayfilter(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues),"$"),"@element" contains "LEGO"),0) -> Value
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues_Name = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues -> ["Name"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues_Value = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues -> ["Value"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_ResultsTruncated = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections -> ResultsTruncated
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationTypeName = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> ["SensitiveInformationTypeName"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveType = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> ["SensitiveType"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_UniqueCount = PolicyDetails_Rules_ConditionsMatched_SensitiveInformation -> UniqueCount
| alter PolicyDetails_Rules_ManagementRuleId = PolicyDetails_Rules -> ["ManagementRuleId"]
| alter PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues_F0816077 = arrayindex(arrayfilter(json_extract_array(to_json_string(PolicyDetails_Rules_ConditionsMatched_SensitiveInformation_SensitiveInformationDetections_DetectedValues),"$"),"@element" contains "F0816077"),0) -> Value


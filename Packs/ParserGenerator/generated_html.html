
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample HTML Document</title>
</head>
<body>
<table>
        
</table>

<h3>Enrichment - Alerts Count</h3><h4>Task 0:</h4><br><strong>- Type: start</strong><br><strong>- Name:</strong> <br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Id:</strong> 0<br><strong>- Type:</strong> start<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 1:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Search Alerts for same user<br><strong>- Description:</strong> Searches Cortex XSIAM Alerts and returnrs the most relevant fields. Default search range is the last 30 days, if you want to change this, use the fromDate argument. 

Returns the id, name, type, severity, status, owner, and created/closed times to context.  You can add additional fields using the add_field_to_context argument.

This automation runs using the default Limited User role, unless you explicitly change the permissions.  Based on the SearchAlertsV2 from the Common Scripts pack, but more efficient.<br><strong>- Scriptname:</strong> SearchAlertsSummary<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;query: username:${alert.username}  -name:"${alert.name}"<br>&nbsp;&nbsp;searchresultslabel: username_search<br><strong>- Id:</strong> 1<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 2:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Set User notable count<br><strong>- Scriptname:</strong> SetContext<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;key: user_notable_count<br>&nbsp;&nbsp;value: {'complex': {'root': 'foundIncidents', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'foundIncidents.searchResultsLabel'}, 'iscontext': True}, 'right': {'value': {'simple': 'username_search'}}}]], 'accessor': 'id', 'transformers': [{'operator': 'count'}]}}<br><strong>- Id:</strong> 2<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 3:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Search Alert for same AWS account<br><strong>- Description:</strong> Searches Cortex XSIAM Alerts and returnrs the most relevant fields. Default search range is the last 30 days, if you want to change this, use the fromDate argument. 

Returns the id, name, type, severity, status, owner, and created/closed times to context.  You can add additional fields using the add_field_to_context argument.

This automation runs using the default Limited User role, unless you explicitly change the permissions.  Based on the SearchAlertsV2 from the Common Scripts pack, but more efficient.<br><strong>- Scriptname:</strong> SearchAlertsSummary<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;query: awsaccountid:"${alert.awsaccountid}"  -name:"${alert.name}"<br>&nbsp;&nbsp;searchresultslabel: accountid_search<br><strong>- Id:</strong> 3<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 4:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Set Account notable count<br><strong>- Scriptname:</strong> SetContext<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;key: account_notable_count<br>&nbsp;&nbsp;value: {'complex': {'root': 'foundIncidents', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'foundIncidents.searchResultsLabel'}, 'iscontext': True}, 'right': {'value': {'simple': 'accountid_search'}}}]], 'accessor': 'id', 'transformers': [{'operator': 'count'}]}}<br><strong>- Id:</strong> 4<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 6:</h4><br><strong>- Type: condition</strong><br><strong>- Name:</strong> If username is available<br><strong>- Type:</strong> condition<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Id:</strong> 6<br><strong>- Type:</strong> condition<br><strong>- Conditions:</strong> [{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'alert.username'}, 'iscontext': True}}]]}]<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 7:</h4><br><strong>- Type: condition</strong><br><strong>- Name:</strong> If account id is available<br><strong>- Type:</strong> condition<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Id:</strong> 7<br><strong>- Type:</strong> condition<br><strong>- Conditions:</strong> [{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'alert.awsaccountid'}, 'iscontext': True}}]]}]<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 8:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Set Context<br><strong>- Scriptname:</strong> SetContext<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;key: user_notable<br>&nbsp;&nbsp;value: No username available to enrich<br><strong>- Id:</strong> 8<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 9:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Set Context<br><strong>- Scriptname:</strong> SetContext<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;key: account_notable<br>&nbsp;&nbsp;value: No account available to enrich<br><strong>- Id:</strong> 9<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 10:</h4><br><strong>- Type: title</strong><br><strong>- Name:</strong> Done<br><strong>- Type:</strong> title<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Id:</strong> 10<br><strong>- Type:</strong> title<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 11:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Set user_notable<br><strong>- Description:</strong> Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

This automation runs using the default Limited User role, unless you explicitly change the permissions.
For more information, see the section about permissions here:
https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations<br><strong>- Scriptname:</strong> SetAndHandleEmpty<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;key: user_notable<br>&nbsp;&nbsp;value: ${user_notable_count} alerts are observed for the same user - ${alert.username}<br><strong>- Id:</strong> 11<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br><h4>Task 12:</h4><br><strong>- Type: regular</strong><br><strong>- Name:</strong> Set account_notable<br><strong>- Description:</strong> Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

This automation runs using the default Limited User role, unless you explicitly change the permissions.
For more information, see the section about permissions here:
https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations<br><strong>- Scriptname:</strong> SetAndHandleEmpty<br><strong>- Type:</strong> regular<br><strong>- Integration Command/Builtin Script:</strong> False<br><strong>- Script Arguments:</strong><br>&nbsp;&nbsp;key: account_notable<br>&nbsp;&nbsp;value: ${account_notable_count} alerts are observed for the same account - ${alert.awsaccountid}<br><strong>- Id:</strong> 12<br><strong>- Type:</strong> regular<br><strong>- Note:</strong> False<br><strong>- Quiet Mode:</strong> On<br></body></html>